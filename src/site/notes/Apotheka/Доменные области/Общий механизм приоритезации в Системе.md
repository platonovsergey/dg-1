---
{"dg-publish":true,"permalink":"/apotheka/domennye-oblasti/obshhij-mehanizm-prioritezaczii-v-sisteme/"}
---


## Общий принцип

## История принятых решений

### Решение 1
[[2024-01-11\|2024-01-11]]


> [!failure]- Статус: Отклонено
> [[2024-01-11\|2024-01-11]]
> 
>Предложение отклонил [[@Олег Вайцехович\|@Олег]], т.к. мы можем решать [[Apotheka/Доменные области/Общий механизм приоритезации в Системе#Проблема\|описанную проблему]] с помощью человека (администратора).
{ #3177c7}


 
#### Контекст: 

- У нас сейчас у прайс-листов есть приоритеты. Каждому прайс-листу привязаны конкретные товары. 

- Чтобы Системе принять решение и вернуть пользователю в публички (в каталоге) стоимость определённых товаров, Система использует приоритеты прайс-листов.

#### Проблема: 

- Может произойти такая ситуация, что например Системе нужно определить стоимость товара "Витамин C". Этот "Витамин C" входит в два прайс-листа и у этих двух прайс-листов *один и тот же приоритет.*

#### Решение проблемы (as-is)

- Сейчас у нас в Системе, уже используется приоритизация для следующих сущностей:
	* Города (Cities)
	* Советы (Advices)
	* Рецепты (Recepies)
	* Баннеры (Banners)
	* Вопросы и ответы (FAQ)
	* Категория для каталогов (Catalogs)
	* Товарная линейки (Product Lines)
	* Товары (Products)
	* Товары, которые могут Вас заинтересовать (Product Combined)
	* Похожие товары, когда выбранный товар закончился (Product Interest)

- Если у сущности один и тот же приоритет, то Система берёт из таблицы БД ту запись, которая была добавлена последней. *Т.е. записи сортируются по приоритету, а потом ещё и по* `id`*.*

```python
q.order_by(p.someEntity.c.priority, p.someEntity.c.id)
```

#### Предложение

Вчера мы обсуждали с тобой, что мы можем сделать приоритеты уникальными, и тогда не нужно будет дополнительно сортировать по `id` (по последней добавленной записи в таблицу БД).